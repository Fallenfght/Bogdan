<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
	<title>Snake</title>
  <script type="module" crossorigin>var S=Object.defineProperty;var x=(c,e,s)=>e in c?S(c,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[e]=s;var a=(c,e,s)=>x(c,typeof e!="symbol"?e+"":e,s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}})();function h(c,e){return Math.floor(Math.random()*(e-c+1))+c}class m{constructor(e,s){this.icon="<span>üçé</span>",this.value=1e3;let i,t;do i=h(0,e.width-1),t=h(0,e.height-1);while(s.isSnakeHere(i,t)||s.isScissorsHere(i,t)||s.isBombHere(i,t));this.x=i,this.y=t;const o=e.cells[i][t];o&&(h(1,10)===1&&(this.value=5e3,this.icon="<span>üçè</span>",o.classList.add("game-board__cell--food-golden")),o.innerHTML=this.icon,o.classList.add("game-board__cell--food"),e.food=this)}static Create(e,s){return new m(e,s)}}const w={top:"bottom",bottom:"top",left:"right",right:"left"},C={ArrowDown:"bottom",KeyS:"bottom",ArrowUp:"top",KeyW:"top",ArrowRight:"right",KeyD:"right",ArrowLeft:"left",KeyA:"left"},l={left:"snake--left",bottom:"snake--bottom",top:"snake--top",right:"snake--right"},d=class d{constructor(e,s,i){a(this,"elements",d.setDefault());a(this,"container");a(this,"direction","right");a(this,"setPartPosition",e=>{e.element.style.left=`${e.x*this.game.config.cellSize}px`,e.element.style.top=`${e.y*this.game.config.cellSize}px`});this.game=e,this.map=s,this.user=i}static setDefault(){return{head:{element:null,x:2,y:0},body:[{element:null,x:1,y:0}],tail:{element:null,x:0,y:0,oldX:0,oldY:0}}}create(e){this.container=document.createElement("div"),this.container.classList.add("snake");const s=(i,t)=>{const o=document.createElement("div");o.style.width=this.game.config.cellSize+"px",o.style.height=this.game.config.cellSize+"px",o.classList.add(`snake__${t}`),t=="head"&&(o.innerHTML='<span class="snake__tongue"></span>');const{x:n,y:r}=i;o.style.left=`${n*this.game.config.cellSize}px`,o.style.top=`${r*this.game.config.cellSize}px`,this.container.appendChild(o),i.element=o};["head","body","tail"].forEach(i=>{const t=this.elements[i];Array.isArray(t)?t.forEach(o=>s(o,i)):s(t,i)}),this.setControlKeys(),e.appendChild(this.container)}destroy(){window.removeEventListener("keydown",this.keyListener),window.removeEventListener("touchstart",this.touchStartListener),window.removeEventListener("touchend",this.touchEndListener),setTimeout(()=>{clearInterval(this.game.interval)},0),this.elements=d.setDefault()}move(){let e,s,i;const t=this.elements.head;switch(e=t.x,s=t.y,this.direction){case"right":t.x++;break;case"left":t.x--;break;case"top":t.y--;break;case"bottom":t.y++;break}if(t.element.classList.remove(...Object.values(l)),t.element.classList.add(l[this.direction]),i=[...t.element.classList].filter(r=>Object.values(l).includes(r)),t.x=(t.x+this.game.config.width)%this.game.config.width,t.y=(t.y+this.game.config.height)%this.game.config.height,this.isSnakeHere(t.x,t.y,!0)||this.isBombHere(t.x,t.y)){this.game.stop("END");return}this.elements.body.forEach(r=>{const y=i,b=r.x,L=r.y;r.x=e,r.y=s,e=b,s=L,i=[...r.element.classList].filter(v=>Object.values(l).includes(v)),r.element.classList.remove(...Object.values(l)),r.element.classList.add(y)});const{tail:o}=this.elements;o.oldX=o.x,o.oldY=o.y,o.x=e,o.y=s;const n=[...o.element.classList].filter(r=>Object.values(l).includes(r));o.element.classList.remove(...Object.values(l)),i.length&&o.element.classList.add(i),this.isFoodHere(t.x,t.y)&&(this.eatFood(),n.length&&(o.element.classList.remove(...Object.values(l)),o.element.classList.add(n))),this.isScissorsHere(t.x,t.y)&&(this.eatScissors(),this.updateSnakePos()),this.updateSnakePos()}isScissorsHere(e,s){return this.map.scissors?this.map.scissors.x===e&&this.map.scissors.y===s:!1}isBombHere(e,s){return this.map.bomb?this.map.bomb.x===e&&this.map.bomb.y===s:!1}isFoodHere(e,s){return this.map.food?this.map.food.x===e&&this.map.food.y===s:!1}isSnakeHere(e,s,i=!1){return[{key:"head",x:this.elements.head.x,y:this.elements.head.y},{x:this.elements.tail.x,y:this.elements.tail.y},...Object.values(this.elements.body)].some(o=>i&&o.key==="head"?!1:o.x===e&&o.y===s)}eatFood(){this.createBodyPart(),this.map.deleteFood(this.elements.head.x,this.elements.head.y),this.user.addScore(this.appleValue.value),this.appleValue=m.Create(this.map,this)}eatScissors(){const e=this.elements.body.length;let s=4e3;if(e>1){this.divideBody(this.scissorsValue);let i=1.1;if(e>=20)i=2;else{const t=Math.min(e/20,1);i=1.1+(2-1.1)*t,s*=i}this.user.addScore(s)}this.map.deleteScissors(this.elements.head.x,this.elements.head.y)}divideBody(e){if(this.elements.body.length<=1)return;let s=null,i=null;const t=this.elements.body.length;let o=Math.round(t/e);t-o<1&&(o=t-1);for(let n=0;n<o&&this.elements.body.length!==0;n++)s=this.elements.body.pop(),i=[...s.element.classList].find(r=>Object.values(l).includes(r)),s.element.remove();this.elements.tail.element.classList.remove(...Object.values(l)),this.elements.tail.element.classList.add(i),this.elements.tail.x=s.x,this.elements.tail.y=s.y,this.setPartPosition(this.elements.tail)}createBodyPart(){const{tail:e}=this.elements,s=document.createElement("div");s.style.width=this.game.config.cellSize+"px",s.style.height=this.game.config.cellSize+"px";const i=[...e.element.classList].filter(o=>Object.values(l).includes(o));s.classList.add("snake__body"),i.length&&s.classList.add(i),this.elements.body.push({element:s,x:e.x,y:e.y}),e.x=e.oldX,e.y=e.oldY;const t=this.elements.body.length;s.style.left=`${this.elements.body[t-1].x*this.game.config.cellSize}px`,s.style.top=`${this.elements.body[t-1].y*this.game.config.cellSize}px`,this.container.insertBefore(s,this.elements.tail.element)}updateSnakePos(){this.setPartPosition(this.elements.head),this.elements.body.forEach(this.setPartPosition),this.setPartPosition(this.elements.tail)}setControlKeys(){this.keyListener&&window.removeEventListener("keydown",this.keyListener),this.touchStartListener&&window.removeEventListener("touchstart",this.touchStartListener),this.touchEndListener&&window.removeEventListener("touchend",this.touchEndListener),this.keyListener=i=>{i.preventDefault();const t=C[i.code];t&&t!==w[this.direction]&&(this.direction=t,clearInterval(this.game.interval),this.move(),this.game.started||(this.game.startBombLoop(),this.game.startScissorsLoop(),this.game.started=!0),this.game.interval=setInterval(()=>{this.move()},this.game.config.speed))};let e=0,s=0;this.touchStartListener=i=>{i.preventDefault(),e=i.touches[0].clientX,s=i.touches[0].clientY},this.touchEndListener=i=>{i.preventDefault();const t=i.changedTouches[0].clientX-e,o=i.changedTouches[0].clientY-s;Math.abs(t)>Math.abs(o)?t>30&&this.direction!=="left"?this.direction="right":t<-30&&this.direction!=="right"&&(this.direction="left"):o>30&&this.direction!=="top"?this.direction="bottom":o<-30&&this.direction!=="bottom"&&(this.direction="top"),clearInterval(this.game.interval),this.move(),this.game.started||(this.game.startBombLoop(),this.game.startScissorsLoop(),this.game.started=!0),this.game.interval=setInterval(()=>{this.move()},this.game.config.speed)},window.addEventListener("keydown",this.keyListener),window.addEventListener("touchstart",this.touchStartListener,{passive:!1}),window.addEventListener("touchend",this.touchEndListener,{passive:!1})}};a(d,"headClass","snake__head"),a(d,"bodyClass","snake__body"),a(d,"tailClass","snake__tail");let f=d;class E{constructor(e){a(this,"food",null);this.config=e,this.cells=[],this.width=e.width,this.height=e.height}destroy(){this.food&&this.deleteFood(this.food.x,this.food.y),this.bomb&&this.deleteBomb(this.bomb.x,this.bomb.y),this.scissors&&this.deleteScissors(this.scissors.x,this.scissors.y),this.config.container.innerHTML="",this.cells=[]}create(e){const s=document.createDocumentFragment();this.config.container.style.width=this.config.containerWidth+"px";for(let i=0;i<this.height;i++)for(let t=0;t<this.width;t++){const o=document.createElement("div");o.classList.add("game-board__cell"),o.style.width=this.config.cellSize+"px",o.style.height=this.config.cellSize+"px",s.appendChild(o),this.cells[t]||(this.cells[t]=[]),this.cells[t][i]=o}e.appendChild(s)}deleteFood(e,s){const i=this.cells[e][s];i.textContent="",i.classList.remove("game-board__cell--food"),this.food=null}deleteBomb(e,s){const i=this.cells[e][s];i.textContent="",i.classList.remove("game-board__cell--bomb"),this.bomb=null}deleteScissors(e,s){const i=this.cells[e][s];i.textContent="",i.classList.remove("game-board__cell--scissors"),this.scissors=null}}class g{constructor(e,s){this.icon="<span>üí£</span>";let i,t;do i=h(0,e.width-1),t=h(0,e.height-1);while(s.isSnakeHere(i,t)||s.isScissorsHere(i,t)||s.isFoodHere(i,t)||[-1,1].some(n=>s.isSnakeHere(i+n,t))||[-1,1].some(n=>s.isSnakeHere(i,t+n)));this.x=i,this.y=t;const o=e.cells[i][t];o&&(o.innerHTML=this.icon,o.classList.add("game-board__cell--bomb"),e.bomb=this)}static Create(e,s){return new g(e,s)}}class p{constructor(e,s){this.icon="<span>‚úÇÔ∏è</span>";let i,t;do i=h(0,e.width-1),t=h(0,e.height-1);while(s.isSnakeHere(i,t)||s.isBombHere(i,t)||s.isFoodHere(i,t)||[-1,1].some(n=>s.isSnakeHere(i+n,t))||[-1,1].some(n=>s.isSnakeHere(i,t+n)));this.x=i,this.y=t;const o=e.cells[i][t];o&&(o.innerHTML=this.icon,o.classList.add("game-board__cell--scissors"),e.scissors=this)}static Create(e,s){return new p(e,s)}}class u{constructor(e){this.config={mainContainer:e.container,scoreContainer:document.querySelector(".score-board__container"),score:0}}create(){const e=document.createElement("div");e.classList.add("user"),e.textContent=`Score: ${this.config.score}`,this.config.mainContainer.appendChild(e),this.scoreItem=e,u.showLeaders()}saveScore(){const e=this.config.score;let s=JSON.parse(localStorage.getItem("highscores"))||[];s.push(e),s.sort((i,t)=>t-i),s=s.slice(0,5),localStorage.setItem("highscores",JSON.stringify(s))}static showLeaders(){const e=document.createElement("div"),s=document.querySelector(".score-board__container");s.innerHTML="",e.classList.add("highscores");const i=JSON.parse(localStorage.getItem("highscores"))||[];if(i.length>0){const t=document.createElement("div");t.classList.add("highscores__title"),t.textContent="üèÜ Highscores:",e.appendChild(t),i.forEach((o,n)=>{const r=document.createElement("div");r.classList.add("highscores__item"),r.textContent=`${n+1}. ${o}`,e.appendChild(r)}),s.appendChild(e)}else s.innerHTML="–°—ã–≥—Ä–∞–π—Ç–µ, —á—Ç–æ–±—ã –∑–∞–Ω—è—Ç—å —Å–≤–æ–µ –º–µ—Å—Ç–æ!"}addScore(e){this.config.score=Math.round(this.config.score+Number(e)),this.scoreItem.textContent=`Score: ${this.config.score}`}multiplyScore(e){this.config.score=Math.round(this.config.score*Number(e)),this.scoreItem.textContent=`Score: ${this.config.score}`}destroy(){this.config.scoreContainer.innerHTML="",this.config.score=0}}class k{constructor(e){const s=window.innerWidth-30;if(this.config={container:document.querySelector(".game-board"),width:10,height:10,speed:350,cellSize:40,...e},s<425){const i=Math.floor(s/this.config.width);this.config.cellSize=i,this.config.height=this.config.width}this.config.containerWidth=Number(this.config.width)*Number(this.config.cellSize),this.map=new E(this.config),this.user=new u(this.config),this.snake=new f(this,this.map,this.user)}start(){this.stop(),this.map.create(this.config.container),this.user.create(),this.snake.create(this.config.container),this.snake.appleValue=m.Create(this.map,this.snake),this.snake.scissorsValue=2}stop(e=!1){this.started=!1,this.snake.destroy(),this.map.destroy(),this.user.saveScore(),this.bombTimeout&&setTimeout(()=>{clearTimeout(this.bombTimeout)},0),this.scissorsTimeout&&setTimeout(()=>{clearTimeout(this.scissorsTimeout)},0),e=="END"&&alert("–í–∞—à —Å—á–µ—Ç: "+this.user.config.score),this.user.destroy()}startBombLoop(){this.bombTimeout&&clearTimeout(this.bombTimeout);const e=h(1500,1e4);this.bombTimeout=setTimeout(()=>{this.map.bomb&&this.map.deleteBomb(this.map.bomb.x,this.map.bomb.y),g.Create(this.map,this.snake),this.startBombLoop()},e)}startScissorsLoop(){this.scissorsTimeout&&clearTimeout(this.scissorsTimeout);const e=h(1e4,3e4);this.scissorsTimeout=setTimeout(()=>{this.map.scissors&&this.map.deleteScissors(this.map.scissors.x,this.map.scissors.y),p.Create(this.map,this.snake),this.startScissorsLoop()},e)}}document.addEventListener("DOMContentLoaded",function(){const c=new k,e=document.querySelector(".btn-start"),s=document.querySelector(".btn-score"),i=document.querySelector(".score-board");e.addEventListener("click",function(t){t.preventDefault(),c.start()}),i.addEventListener("click",function(){this.classList.remove("score-board--active")}),s.addEventListener("click",function(t){t.preventDefault(),u.showLeaders(),i.classList.toggle("score-board--active")})});</script>
  <style rel="stylesheet" crossorigin>body{font-family:"Press Start 2P";margin:0;padding:15px}.btn{padding:12px 24px;font-size:18px;border-radius:8px;cursor:pointer;transition:all .2s ease;text-transform:uppercase;font-family:inherit}.btn-score{margin:0 auto 60px;background:linear-gradient(145deg,#1976d2,#1565c0);border:3px solid #0d47a1;color:#fff}.btn-start{background:linear-gradient(145deg,#43a047,#388e3c);border:3px solid #2e7d32;color:#fff;margin:0 auto 15px}.btn-start:hover{background:linear-gradient(145deg,#4caf50,#43a047)}.btn-start:active{transform:translateY(2px)}.game-board{display:flex;flex-wrap:wrap;position:relative}.game-board__cell{width:40px;height:40px;background-color:#a1887f;background-image:radial-gradient(circle,rgba(0,0,0,.03) 1px,transparent 1px);background-size:10px 10px;border:1px solid #4e342e;box-sizing:border-box}.snake{position:absolute;left:0;top:0;z-index:100;display:flex}.snake__body,.snake__head,.snake__tail{width:40px;height:40px;position:absolute}.snake__body{background:linear-gradient(to bottom,#81c784,#66bb6a,#388e3c);border:1px solid #2e7d32;box-shadow:inset 0 1px 3px #ffffff4d;border-radius:5px}.snake__tail{border-top-left-radius:20px;border-bottom-left-radius:20px;background:#388e3c}.snake__head{position:relative;border-top-right-radius:20px;border-bottom-right-radius:20px;background:#4caf50}.snake__head:after,.snake__head:before{content:"‚ö´";font-size:2px;position:absolute;border-radius:50%;background:#ffeb3b;color:#388e3c;width:5px;height:5px;right:10px;display:flex;align-items:center;justify-content:flex-end}.snake__tongue{position:absolute;right:-11px;bottom:-3px;transform:translate(-50%) rotate(0)}.snake__tongue:after{content:"";width:8px;height:10px;background:#d32f2f;border-radius:0 0 4px 4px;display:block;animation:tongueSqueeze 3s infinite alternate;animation-delay:2s;transform-origin:0 0;transform:translate(-50%) rotate(-59deg) scaleY(1)}.snake__head:before{top:10px}.snake__head:after{bottom:10px}.snake__head.snake--top{transform:rotate(-90deg)}.snake__head.snake--bottom{transform:rotate(90deg)}.snake__head.snake--left{transform:rotate(-180deg)}.snake__tail.snake--top{transform:rotate(-90deg)}.snake__tail.snake--bottom{transform:rotate(90deg)}.snake__tail.snake--left{transform:rotate(-180deg)}.game-board__cell--food,.game-board__cell--bomb,.game-board__cell--scissors{border:1px solid #6d4c41;font-size:20px;display:flex;justify-content:center;align-items:center;transition:box-shadow .3s ease;z-index:5}.game-board__cell--food span{animation:emojiDance 2s infinite ease-in-out;box-shadow:0 0 12px 6px #ff646480;display:block;border-radius:50%}.game-board__cell--food.game-board__cell--food-golden span{box-shadow:0 0 12px 6px #fff56480}.game-board__cell--scissors span{animation:emojiDance 2s 1s infinite ease-in-out;box-shadow:0 0 12px 6px #ffffff80;border-radius:8px}.game-board__cell--bomb span{animation:emojiPulse 2s infinite ease-in-out alternate}.user{position:absolute;left:50%;top:0;background:#333;padding:7px 5px;border-radius:4px;transform:translate(-50%,-100%);color:#fff;font-size:20px;line-height:1;font-weight:700;text-transform:uppercase;box-sizing:border-box;margin-bottom:15px;white-space:nowrap}.highscores{white-space:nowrap;color:gold;box-sizing:border-box}.highscores__title{margin:0 0 20px;font-size:16px;line-height:1}.highscores__item{margin:0 0 10px;font-size:14px;line-height:1}.score-board{position:fixed;z-index:10;top:0;left:0;right:0;bottom:0;background:#0009;color:#fff;visibility:hidden;opacity:0;transition:opacity .2s ease,visibility .2s ease}.score-board__container{padding:30px 15px;border-radius:8px;background:#333;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.score-board.score-board--active{opacity:1;visibility:visible}@keyframes tongueSqueeze{0%{transform:translate(-50%) rotate(-59deg) scaleY(1)}25%{transform:translate(-50%) rotate(-55deg) scaleY(1.1)}50%{transform:translate(-50%) rotate(-65deg) scaleY(.2)}75%{transform:translate(-50%) rotate(-55deg) scaleY(1.1)}to{transform:translate(-50%) rotate(-59deg) scaleY(1)}}@keyframes emojiPulse{0%{transform:scale(1) rotate(12deg)}to{transform:scale(1.2) rotate(0)}}@keyframes emojiDance{0%{transform:scale(1) rotate(0) translateY(0)}25%{transform:scale(1.1) rotate(-5deg) translateY(-2px)}50%{transform:scale(1.05) rotate(5deg) translateY(0)}75%{transform:scale(1.1) rotate(-3deg) translateY(-1px)}to{transform:scale(1) rotate(0) translateY(0)}}@media (min-width: 426px){.game-board__cell--food,.game-board__cell--bomb,.game-board__cell--scissors{font-size:24px}}</style>
</head>
<body>
	<button type="button" class="btn btn-start">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
	<button type="button" class="btn btn-score">–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞</button>
	<div class="game-board"></div>
	<div class="score-board">
		<div class="score-board__container">
			
		</div>
	</div>
</body>
</html>